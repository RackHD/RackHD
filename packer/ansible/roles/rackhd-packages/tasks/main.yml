---
- name: Ensure rackhd bintray key
  apt_key: id={{ rackhd_key_id }} keyserver={{ rackhd_keyserver }} state=present
  tags:
    - rackhd

- name: Create the rackhd bintray repo
  apt_repository: repo="{{ rackhd_repo }}" state=present
  tags:
    - rackhd

- name: Install rackhd packages
  apt: name={{item}} state=installed
  with_items: "{{ rackhd_packages }}"
  tags:
    - rackhd

- name: rackhd default service files
  copy: content="" dest=/etc/default/{{item}} force=no
  with_items: "{{ rackhd_services }}"
  tags:
    - rackhd

- name: rackhd start services
  service: name={{ item }} state=started enabled=yes
  with_items: "{{ rackhd_services }}"
  tags:
    - rackhd

- name: set HTTP static directory for RackHD
  set_fact: http_static_directory="{{ rackhd_http_static_directory }}"
  tags:
    - rackhd

- name: set TFTP static directory for RackHD
  set_fact: tftp_static_directory="{{ rackhd_tftp_static_directory }}"
  tags:
    - rackhd

